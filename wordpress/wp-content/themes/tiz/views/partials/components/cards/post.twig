{# Post cards list
Inputs:
- items: [
    {
      image: ACF image array or { src, alt } (required),
      title: string (required),
      text: string (optional),
      link: string (optional) — if provided, whole card becomes clickable,
      tags: [ // up to 3
        { label: string (required), link: string (required), colorKey: 'dodger-blue'|'azure-radiance'|'mantis'|'bay-of-many'|'wild-blue-yonder' (optional) }
      ]
    }
  ]
- grid_classes: string for the grid wrapper (default: 1-2-3 cols)
- card_classes: string to extend card styles

Notes:
- Tag colors are predetermined via label→color mapping with optional colorKey override.
- Bottom accent bar is always bg-dodger-blue-600.
#}
{% if items and items|length %}
  {# Tailwind-safe maps with full class strings (avoid dynamic fragments) #}
  {% set tag_styles = {
    'dodger-blue': 'text-dodger-blue-700',
    'azure-radiance': 'text-azure-radiance-700',
    'mantis': 'text-mantis-700',
    'bay-of-many': 'text-bay-of-many-700',
    'wild-blue-yonder': 'text-wild-blue-yonder-700'
  } %}
  <style>
    .post-tag-chip { 
      border-color: var(--tag-color); 
      color: #273a7c;
      background: var(--tag-bg, transparent);
      transition: background-color .4s ease, color .4s ease, border-color .4s ease;
    }
    .post-tag-chip:hover { 
      background: var(--tag-color); 
      color: #fff; 
      border-color: var(--tag-color);
    }
  </style>
  {% set label_color_map = {
    'Développement': 'mantis',
    'Design': 'dodger-blue',
    'Business': 'azure-radiance',
    'Marketing': 'wild-blue-yonder',
    'Audiovisuel': 'azure-radiance',
    'Contenus': 'bay-of-many'
  } %}

  <div class="{{ grid_classes|default('grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6') }}">
    {% for item in items %}
      <article class="scroll-animate group relative overflow-hidden rounded-tiz bg-black-haze-50 shadow-none transition duration-500 will-change-transform hover:-translate-y-2 hover:shadow-[0_2rem_6rem_rgba(35,58,124,0.2)] hover:bg-white focus-within:-translate-y-2 {{ card_classes }}">
        {# Clickable surface (optional) #}
        {% if item.link %}
          <a href="{{ item.link }}" class="absolute inset-0 z-10" aria-label="{{ item.title }}"></a>
        {% endif %}

        {# Top image full width #}
        {% if item.image %}
          <div class="relative w-full aspect-[16/9] overflow-hidden">
            {# ACF image component with fallback alt text #}
            {% include 'partials/components/acf-image.twig' with {
              image: item.image,
              class: 'absolute inset-0 h-full w-full object-cover group-hover:scale-110 transition-transform duration-3000 ease-in-out',
              size: 'large',
              alt: item.image.alt|default(item.title|default(''))
            } %}
          </div>
        {% endif %}

        {# Content #}
        <div class="p-10">
          {# Hashtags (1..3) #}
          {% set tags = (item.tags|default([]))[:3] %}
          {% if tags and tags|length %}
            <div class="mb-5 flex flex-wrap items-center gap-3">
              {% for tag in tags %}
                {% set label = tag.label|default('') %}
                {% set key = tag.colorKey|default(label_color_map[label]|default('dodger-blue')) %}
                {% set colorClasses = tag_styles[key]|default(tag_styles['dodger-blue']) %}
                {% set href = tag.link|default('#') %}
                {% set hex = tag.color|default(null) %}
                {% set fallback = (key == 'mantis') ? '#16a34a' : (key == 'azure-radiance' ? '#0d6efd' : (key == 'dodger-blue' ? '#1e90ff' : (key == 'wild-blue-yonder' ? '#647b9c' : '#1f355c'))) %}
                {% set effective = hex|default(fallback) %}
                <a href="{{ href }}" class="post-tag-chip relative z-20 inline-flex items-center rounded-full border px-3 py-1 text-xs md:text-sm font-medium {{ colorClasses }}" style="--tag-color: {{ effective }};">
                  {{ label }}
                </a>
              {% endfor %}
            </div>
          {% endif %}

          {# Title #}
          {% if item.title %}
            <h3 id="card-{{ loop.index }}-title" class="relative w-fit text-xl md:text-2xl text-bay-of-many-900 text-bay-of-many-900">
              {{ item.title }}
      
            </h3>
          {% endif %}

          {# Text #}
          {% if item.text %}
            <p class="mt-4 text-sm md:text-base text-wild-blue-yonder-600">{{ item.text }}</p>
          {% endif %}
          <p class="flex font-bold uppercase text-bay-of-many-900 m-auto mb-0 ml-0 text-sm pt-3 ">
						Lire plus
						<svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" fill="none" stroke="currentColor" class="w-4 h-4 transition-transform ml-1 m-auto duration-300 group-hover:translate-x-1" {% if use_inline %} style="color: {{ item.accent_color }}" {% endif %}>
							<path d="M9 5l7 7-7 7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
						</svg>
					</p>
        </div>

        {# Bottom accent bar (always dodger-blue) #}
        <span class="pointer-events-none absolute bottom-0 left-0 h-1 w-full origin-left scale-x-0 group-hover:scale-x-100 transition-transform duration-500 bg-dodger-blue-600"></span>
      </article>
    {% endfor %}
  </div>
{% endif %}
